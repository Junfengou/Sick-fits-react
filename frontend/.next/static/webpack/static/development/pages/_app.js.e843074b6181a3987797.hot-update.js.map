{"version":3,"file":"static/webpack/static\\development\\pages\\_app.js.e843074b6181a3987797.hot-update.js","sources":["webpack:///./components/Search.js"],"sourcesContent":["import React from \"react\";\r\nimport Downshift from \"downshift\";\r\nimport Router from \"next/router\";\r\n// ApolloConsumer is what allows us to query on demand instead of page load\r\nimport { ApolloConsumer } from \"react-apollo\";\r\nimport gql from \"graphql-tag\";\r\n/* This debounce import will put a limit on the amount of keyup events generated by the user to prevent DDOS or server crash for \r\n    recieving too many requests in a short amount of time.\r\n*/\r\nimport debounce from \"lodash.debounce\";\r\nimport { DropDown, DropDownItem, SearchStyles } from \"./styles/DropDown\";\r\n\r\nconst SEARCH_ITEM_QUERY = gql`\r\n\tquery SEARCH_ITEM_QUERY($searchTerm: String!) {\r\n\t\titems(\r\n\t\t\twhere: {\r\n\t\t\t\tOR: [\r\n\t\t\t\t\t{ title_contains: $searchTerm }\r\n\t\t\t\t\t{ description_contains: $searchTerm }\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t) {\r\n\t\t\tid\r\n\t\t\timage\r\n\t\t\ttitle\r\n\t\t}\r\n\t}\r\n`;\r\n\r\n/*\r\n    <Query query={SEARCH_ITEM_QUERY}>\r\n    {(items, {data, loading, error}) => (\r\n        ......\r\n    )}\r\n    </Query>\r\n\r\n    IMPORTANT NOTE: \r\n        normally when you make a query on the client side, you wrap everything you want to return inside of the query tag\r\n        then what happen is the query will fetch the information from the backend on page load. \r\n\r\n        HOWEVER, on something like search options, you want to ONLY run the query when the user is typing something in. \r\n        To work around this issue, you can use [ApolloConsumer] to query on demand\r\n\r\n*/\r\n\r\nclass AutoComplete extends React.Component {\r\n\tstate = {\r\n\t\titems: [],\r\n\t\tloading: false,\r\n\t};\r\n\tonChange = debounce(async (e, client) => {\r\n\t\tconsole.log(\"Searching...\");\r\n\t\t// turn loading on\r\n\t\tthis.setState({ loading: true });\r\n\t\t// Manually query apollo client\r\n\t\tconst res = await client.query({\r\n\t\t\tquery: SEARCH_ITEM_QUERY,\r\n\t\t\tvariables: { searchTerm: e.target.value },\r\n\t\t});\r\n\t\tthis.setState({\r\n\t\t\titems: res.data.items,\r\n\t\t\tloading: false,\r\n\t\t});\r\n\t}, 350);\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<SearchStyles>\r\n\t\t\t\t<Downshift>\r\n\t\t\t\t\t{({\r\n\t\t\t\t\t\tgetInputProps,\r\n\t\t\t\t\t\tgetItemProps,\r\n\t\t\t\t\t\tisOpen,\r\n\t\t\t\t\t\tinputValue,\r\n\t\t\t\t\t\thighlightedIndex,\r\n\t\t\t\t\t}) => (\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<ApolloConsumer>\r\n\t\t\t\t\t\t\t\t{(client) => (\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t{...getInputProps({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: \"search\",\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder: \"Search For An Item\",\r\n\t\t\t\t\t\t\t\t\t\t\tid: \"search\",\r\n\t\t\t\t\t\t\t\t\t\t\tclassName: this.state.loading ? \"loading\" : \"\",\r\n\t\t\t\t\t\t\t\t\t\t\tonChange: (e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\te.persist();\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.onChange(e, client);\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</ApolloConsumer>\r\n\t\t\t\t\t\t\t<DropDown>\r\n\t\t\t\t\t\t\t\t{this.state.items.map((item) => (\r\n\t\t\t\t\t\t\t\t\t<DropDownItem key={item.id}>\r\n\t\t\t\t\t\t\t\t\t\t<img width=\"50\" src={item.image} alt={item.title} />\r\n\t\t\t\t\t\t\t\t\t\t{item.title}\r\n\t\t\t\t\t\t\t\t\t</DropDownItem>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</DropDown>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Downshift>\r\n\t\t\t</SearchStyles>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default AutoComplete;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAGA;AACA;AAEA;AAiBA;;;;;;;;;;;;;;;;AAgBA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AAFA;AACA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AALA;AAAA;AAMA;AACA;AAAA;AAAA;AAFA;AACA;AANA;AAKA;AACA;AAGA;AACA;AACA;AAFA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;;;;;;AAaA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AARA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAzBA;AAqCA;;;;AA5DA;AACA;AA8DA;;;;A","sourceRoot":""}